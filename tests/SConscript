# -*- python -*-
Import('env')
import glob, os

for src in glob.glob("*.cc"):
    env.Program(src, LIBS=env.getlibs(env["eups_product"]))

if not env.CleanFlagIsSet():
    import lsst.tests
    import lsst.daf.persistence

    tests = lsst.tests.Control(env, verbose = True)

    envKeys = ['LSST_DB_AUTH', 'LSST_RNG_SEED', 'LSST_RNG_ALGORITHM']
    for key in envKeys:
        if os.environ.has_key(key):
            env['ENV'][key] = os.environ[key]

    tests.run("*.cc")
    for target in tests.run("*.py"):
        env.Depends(target, "../python/lsst/ap/_apLib%s" % env['LDMODULESUFFIX'])

